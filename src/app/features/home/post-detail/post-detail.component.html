<div
  *ngIf="post"
  class="max-w-4xl mt-4 mx-auto p-4 bg-white rounded-lg shadow-lg"
>
  <!-- Заголовок поста -->
  <h2 class="text-4xl font-bold text-gray-900 mb-6">{{ post.title }}</h2>

  <!-- Автор поста та дата -->
  <div class="flex items-center mb-6">
    <img
      [src]="post.profilePictureUrl || '/assets/images/Sample_User_Icon.png'"
      alt="Author's Profile Picture"
      class="w-12 h-12 object-cover rounded-full mr-4"
    />
    <div>
      <h4 class="text-xl font-semibold text-gray-800">{{ post.userName }}</h4>
      <p class="text-sm text-gray-500">
        {{ post.createdAt | date : "medium" }}
      </p>
    </div>
  </div>

  <!-- Категорії поста -->
  <div class="mb-6">
    <p class="text-sm font-semibold text-gray-600">Categories</p>
    <p class="text-gray-600 text-sm">
      {{ post.categoryNames.join(", ") }}
    </p>
  </div>

  <!-- Контент поста -->
  <p class="text-gray-800 text-lg mb-6">{{ post.content }}</p>

  <div
    class="flex items-center justify-between text-gray-600 text-sm mt-4 mb-4 border-t pt-4"
  >
    <!-- Блок лайків -->
    <div class="flex items-center">
      <button
        class="flex items-center text-sm text-gray-600 bg-transparent border-none cursor-pointer"
        [class.liked]="isLiked"
        (click)="toggleLike()"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          width="20"
          height="20"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="feather feather-credit-card"
        >
          <path
            d="M22 12V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6"
          ></path>
          <rect x="2" y="10" width="20" height="4" rx="1" ry="1"></rect>
        </svg>
        Likes {{ post.likesCount }}
      </button>
    </div>

    <!-- Блок коментарів -->
    <div class="flex items-center ml-4">
      <button class="flex items-center group hover:text-blue-600">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5 mr-1"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M8 10h8m-8 4h4m1-14a7 7 0 11-14 0 7 7 0 0114 0z"
          ></path>
        </svg>
        Comment
        <span class="ml-2 text-gray-600 group-hover:text-blue-600">{{
          comments().length
        }}</span>
      </button>
    </div>
  </div>

  <div class="mb-6">
    <form
      (ngSubmit)="createNewComment(form)"
      #form="ngForm"
      class="flex flex-col"
    >
      <!-- Поле для введення коментаря -->
      <textarea
        class="w-full px-4 py-2 mb-3 text-sm border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 transition"
        rows="4"
        placeholder="Write your comment here..."
        name="content"
        ngModel
        required
      ></textarea>

      <!-- Кнопка для відправки -->
      <button
        type="submit"
        class="self-end flex items-center px-4 py-2 text-sm font-medium text-white bg-blue-500 rounded-lg hover:bg-blue-600 transition"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5 mr-2"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M5 13l4 4L19 7"
          ></path>
        </svg>
        Post Comment
      </button>
    </form>
  </div>

  <!-- Блок коментарів -->
  <div class="mt-8">
    <h3 class="text-2xl font-semibold text-gray-900 mb-4">Comments</h3>

    <!-- Перевірка на наявність коментарів -->
<div *ngIf="comments() && comments().length > 0; else noComments">
  <ul class="space-y-4">
    <li
      *ngFor="let comment of getSortedComments()"
      class="p-4 bg-gray-100 rounded-md shadow-sm relative"
    >
      <p class="text-lg text-gray-800">{{ comment.content }}</p>
      <p class="text-sm text-gray-500 mt-2">
        — {{ comment.authorName }} on
        {{ comment.createdAt | date : "short" }}
      </p>

      <!-- Меню з трьома крапками -->
      <button
        (click)="toggleMenu(comment.id)"
        class="absolute top-2 right-2"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 12h12M6 6h12M6 18h12"
          />
        </svg>
      </button>

      <!-- Випадне меню -->
      <div
        *ngIf="selectedCommentId === comment.id"
        class="absolute right-2 top-10 bg-white border rounded shadow-lg z-10"
      >
        <!-- Перевірка, чи є автором коментаря поточний користувач -->
        <button
          *ngIf="comment.authorName === authService.currentUser()?.user?.username" 
          (click)="deleteComment(comment.id)"
          class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"
        >
          Delete
        </button>
        
        <!-- Кнопка Add для всіх інших користувачів -->
        <button
          *ngIf="comment.authorName !== authService.currentUser()?.user?.username" 
          class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"
        >
          Add
        </button>
      </div>
    </li>
  </ul>
</div>

<!-- Повідомлення, якщо коментарів немає -->
<ng-template #noComments>
  <p class="text-gray-600">No comments yet. Be the first to comment!</p>
</ng-template>


  </div>
</div>
